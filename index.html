<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ìŠ¤íƒ í¼ì¦</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background-color: #f8f9fa; text-align: center; padding-top: 50px; }
    #grid { display: flex; justify-content: center; gap: 8px; margin-top: 20px; }
    .column {
      width: 60px;
      height: 240px; /* 6 tiles * 40px/tile = 240px */
      background: #e9ecef;
      display: flex;
      flex-direction: column-reverse; /* ë¸”ë¡ì´ ì•„ë˜ì—ì„œ ìœ„ë¡œ ìŒ“ì´ë„ë¡ */
      justify-content: start;
      padding: 4px;
      border-radius: 4px;
      transition: background-color 0.2s ease; /* í˜¸ë²„ íš¨ê³¼ë¥¼ ë¶€ë“œëŸ½ê²Œ */
    }
    .column:hover {
      background-color: #dee2e6; /* í˜¸ë²„ ì‹œ ìƒ‰ìƒ ë³€ê²½ */
      cursor: pointer;
    }
    .tile {
      width: 100%;
      height: 40px;
      background-color: #ffffff;
      margin-bottom: 4px;
      font-weight: bold;
      line-height: 40px; /* í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
      border-radius: 4px;
      box-shadow: 0 0 3px rgba(0,0,0,0.1);
      color: #333; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
      display: flex; /* Flexboxë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚´ìš© ì¤‘ì•™ ì •ë ¬ */
      align-items: center;
      justify-content: center;
    }
    /* ìˆ«ìì— ë”°ë¼ ë¸”ë¡ ìƒ‰ìƒ ë³€ê²½ */
    .tile[data-num="1"] { background-color: #a8dadc; }
    .tile[data-num="2"] { background-color: #fca3b7; }
    .tile[data-num="3"] { background-color: #c9e2b1; }
    .tile[data-num="4"] { background-color: #ffda79; }
    .tile[data-num="5"] { background-color: #d1b8ff; }

    #next {
      font-size: 24px;
      margin-top: 10px;
      font-weight: bold;
    }
    #nextNum {
      color: #007bff; /* ë‹¤ìŒ ë¸”ë¡ ìˆ«ì ìƒ‰ìƒ */
    }
    #status {
      min-height: 24px; /* ë©”ì‹œì§€ê°€ ì—†ì„ ë•Œ ê³µê°„ í™•ë³´ */
    }
  </style>
</head>
<body>
  <h1 class="mb-3">ğŸ”¢ ìŠ¤íƒ ì •ë ¬ í¼ì¦</h1>
  <p class="text-muted">ê°™ì€ ìˆ«ì 3ê°œê°€ ìŒ“ì´ë©´ ì‚¬ë¼ì ¸ìš”!</p>
  <div id="next">ë‹¤ìŒ ë¸”ë¡: <span id="nextNum"></span></div>
  <div id="grid" class="mt-3"></div>
  <p id="status" class="mt-4 fw-bold"></p>

  <script>
    const cols = 5; // ì—´ì˜ ê°œìˆ˜
    const colHeight = 6; // ê° ì—´ì˜ ìµœëŒ€ ë†’ì´ (ë¸”ë¡ ê°œìˆ˜)
    const maxNumber = 5; // ë¸”ë¡ì— ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ìµœëŒ€ ìˆ«ì (1ë¶€í„° maxNumberê¹Œì§€)

    const gridEl = document.getElementById("grid");
    const nextEl = document.getElementById("nextNum");
    const statusEl = document.getElementById("status");

    let nextNumber = 1 + Math.floor(Math.random() * maxNumber); // ë‹¤ìŒìœ¼ë¡œ ë‚˜ì˜¬ ë¸”ë¡ ìˆ«ì
    const stacks = Array.from({ length: cols }, () => []); // ê° ì—´ì˜ ìŠ¤íƒì„ ì €ì¥í•  ë°°ì—´

    // ê²Œì„ ì´ˆê¸°í™”: ìŠ¤íƒì— ë¬´ì‘ìœ„ ë¸”ë¡ ì±„ìš°ê¸°
    function initializeStacks() {
      for (let i = 0; i < cols; i++) {
        // ê° ì—´ì— 0ê°œ, 1ê°œ, ë˜ëŠ” 2ê°œì˜ ì´ˆê¸° ë¸”ë¡ì„ ë¬´ì‘ìœ„ë¡œ ì¶”ê°€
        const initialBlocks = Math.floor(Math.random() * 3);
        for (let j = 0; j < initialBlocks; j++) {
          stacks[i].push(1 + Math.floor(Math.random() * maxNumber)); // 1ë¶€í„° maxNumberê¹Œì§€ì˜ ìˆ«ì
        }
      }
    }

    // ê·¸ë¦¬ë“œë¥¼ í™”ë©´ì— ê·¸ë¦¬ëŠ” í•¨ìˆ˜
    function renderGrid() {
      gridEl.innerHTML = ""; // ê¸°ì¡´ ê·¸ë¦¬ë“œ ë‚´ìš©ì„ ì§€ìš°ê³  ìƒˆë¡œ ê·¸ë¦½ë‹ˆë‹¤.
      for (let i = 0; i < cols; i++) {
        const colEl = document.createElement("div");
        colEl.className = "column";
        colEl.dataset.index = i;
        colEl.addEventListener("click", () => placeTile(i)); // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€

        // í˜„ì¬ ìŠ¤íƒì— ìˆëŠ” ë¸”ë¡ë“¤ì„ ê·¸ë¦½ë‹ˆë‹¤.
        stacks[i].forEach(n => {
          const tile = document.createElement("div");
          tile.className = "tile";
          tile.textContent = n;
          tile.dataset.num = n; // CSS ìŠ¤íƒ€ì¼ë§ì„ ìœ„í•´ data-num ì†ì„± ì¶”ê°€
          colEl.appendChild(tile);
        });
        gridEl.appendChild(colEl);
      }
    }

    // ë‹¤ìŒ ë¸”ë¡ ìˆ«ìë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function updateNext() {
      nextNumber = 1 + Math.floor(Math.random() * maxNumber); // 1ë¶€í„° maxNumberê¹Œì§€ì˜ ìˆ«ì
      nextEl.textContent = nextNumber;
    }

    // ë¸”ë¡ì„ ë°°ì¹˜í•˜ëŠ” í•¨ìˆ˜
    function placeTile(index) {
      statusEl.textContent = ""; // ë©”ì‹œì§€ ì´ˆê¸°í™”

      if (stacks[index].length >= colHeight) {
        statusEl.textContent = "âŒ ê²Œì„ ì˜¤ë²„ - ë„ˆë¬´ ë§ì´ ìŒ“ì˜€ì–´ìš”! ë‹¤ë¥¸ ì¹¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return; // ì¹¸ì´ ê°€ë“ ì°¼ìœ¼ë©´ ë¸”ë¡ì„ ë†“ì§€ ì•Šê³  ì¢…ë£Œ
      }
      stacks[index].push(nextNumber); // í˜„ì¬ ë¸”ë¡ì„ ìŠ¤íƒì— ì¶”ê°€
      
      checkClear(index); // ë¸”ë¡ ì¶”ê°€ í›„ 3ê°œ ì—°ì† ë§¤ì¹˜ í™•ì¸
      updateNext(); // ë‹¤ìŒ ë¸”ë¡ ì—…ë°ì´íŠ¸
      renderGrid(); // ê·¸ë¦¬ë“œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    }

    // ë¸”ë¡ 3ê°œ ì—°ì† ë§¤ì¹˜ë¥¼ í™•ì¸í•˜ê³  ì œê±°í•˜ëŠ” í•¨ìˆ˜
    function checkClear(colIndex) {
      const stack = stacks[colIndex];
      // ìŠ¤íƒì˜ ê¸¸ì´ê°€ ìµœì†Œ 3ê°œ ì´ìƒì´ì–´ì•¼ í™•ì¸ ê°€ëŠ¥
      if (stack.length >= 3) {
        // ìŠ¤íƒì˜ ê°€ì¥ ìœ„ìª½ 3ê°œ ë¸”ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const top3 = stack.slice(-3);
        // ì„¸ ë¸”ë¡ì˜ ìˆ«ìê°€ ëª¨ë‘ ê°™ì€ì§€ í™•ì¸í•©ë‹ˆë‹¤.
        if (top3[0] === top3[1] && top3[1] === top3[2]) {
          stack.splice(-3, 3); // ê°™ì€ ìˆ«ì 3ê°œë¥¼ ìŠ¤íƒì—ì„œ ì œê±°í•©ë‹ˆë‹¤.
          statusEl.textContent = "âœ… ë¸”ë¡ 3ê°œ ì œê±°!";
        }
      }
    }

    // ê²Œì„ ì‹œì‘ ì‹œ ì´ˆê¸°í™” ë° ë Œë”ë§
    initializeStacks();
    renderGrid();
    updateNext();
  </script>
</body>
</html>
